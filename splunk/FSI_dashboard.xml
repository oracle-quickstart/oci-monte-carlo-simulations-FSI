<form>
  <label>FSI Monte Carlo Simulator</label>
  <fieldset submitButton="false">
    <input type="time" token="ttime">
      <label></label>
      <default>
        <earliest>@d</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
  <row>
    <panel>
      <title>TOTAL TASKS</title>
      <single>
        <search>
          <query>index="main" | stats count as TASKS</query>
          <earliest>$ttime.earliest$</earliest>
          <latest>$ttime.latest$</latest>
        </search>
        <option name="drilldown">none</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>EXECUTIONS</title>
      <table>
        <search>
          <query>index="main" | 
eval epoch_submit_time = strptime(submit_time, "%Y-%m-%d %H:%M:%S.%6N") | 
eval epoch_start_time = strptime(start_time, "%Y-%m-%d %H:%M:%S.%6N") |
eval epoch_end_time = strptime(onclient_time, "%Y-%m-%d %H:%M:%S.%6N") |
eval epoch_exec_time = strptime(exec_time, "%H:%M:%S.%6N") |
eval epoch_pending_time = epoch_start_time - epoch_submit_time |
stats avg(epoch_pending_time) as AVG_PENDING avg(epoch_exec_time) as AVG_CPP min(epoch_submit_time) as MIN_SUBMIT MAX(epoch_end_time) as MAX_END count as TOTAL_TASKS avg(num_sims) as NUM_SIMS by portfolio_id |
eval epoch_total_time = MAX_END - MIN_SUBMIT |
stats avg(epoch_total_time) as AVG_TOTAL avg(AVG_PENDING) as AVG_PENDING avg(AVG_CPP) as AVG_CPP AVG(TOTAL_TASKS) as TOTAL_TASKS avg(NUM_SIMS) as NUM_SIMS by portfolio_id |
eval TOTAL_TIME = strftime(AVG_TOTAL, "%H:%M:%S.%6N") |
eval AVG_CPP_TIME = strftime(AVG_CPP, "%H:%M:%S.%6N") |
eval AVG_PENDING_TIME = strftime(AVG_PENDING, "%H:%M:%S.%6N") |
eval TASKS_TYPE = if(NUM_SIMS &gt; 3000000, "COMPLEX", "SIMPLE") |
rename portfolio_id as PORTFOLIO_ID |
table PORTFOLIO_ID TOTAL_TIME AVG_PENDING_TIME AVG_CPP_TIME TOTAL_TASKS TASKS_TYPE</query>
          <earliest>$ttime.earliest$</earliest>
          <latest>$ttime.latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="count">20</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <title>TASKS EXECUTED BY WORKER</title>
        <search>
          <query>index="main" | stats count as TOTAL by worker | sort - by TOTAL</query>
          <earliest>$ttime.earliest$</earliest>
          <latest>$ttime.latest$</latest>
        </search>
        <option name="charting.chart">column</option>
        <option name="charting.drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <input type="text" token="tportfoliot">
        <label>PORTFOLIO_ID</label>
      </input>
      <chart>
        <search>
          <query>index="main" portfolio_id=$tportfoliot$ | eval time=round(maturity*12, 0) | 
eval epoch_submit_time = strptime(submit_time, "%Y-%m-%d %H:%M:%S.%6N") | 
eval formated_time=relative_time(epoch_submit_time, "+"+time+"mon") |
eval finish_time = strftime(formated_time, "%Y-%m-%d %H:%M:%S.%6N") |
eval _time=strptime(finish_time, "%Y-%m-%d %H:%M:%S.%6N") |
timechart max(call_price) as "Call Price"</query>
          <earliest>$ttime.earliest$</earliest>
          <latest>$ttime.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-45</option>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">none</option>
        <option name="height">339</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <chart>
        <search>
          <query>index="main" portfolio_id=$tportfoliot$ | eval time=round(maturity*12, 0) | 
eval epoch_submit_time = strptime(submit_time, "%Y-%m-%d %H:%M:%S.%6N") | 
eval formated_time=relative_time(epoch_submit_time, "+"+time+"mon") |
eval finish_time = strftime(formated_time, "%Y-%m-%d %H:%M:%S.%6N") |
eval _time=strptime(finish_time, "%Y-%m-%d %H:%M:%S.%6N") |
timechart max(put_price) as "Put Price"</query>
          <earliest>$ttime.earliest$</earliest>
          <latest>$ttime.latest$</latest>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">-45</option>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">none</option>
        <option name="height">324</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
</form>
